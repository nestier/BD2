<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
 "-//Hibernate/Hibernate Mapping DTD//EN"
 "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"> 

<hibernate-mapping package="bd2.model">

   <class name="Leccion" table="Leccion">
      <id name="id" type="long" column="leccion_id">
        <generator class="native"/>
      </id>
      <property name="nombre" column="nombre" type="string"/>
   </class>
   
   <class name="Curso" table="Curso">
      <id name="id" type="long" column="curso_id">
        <generator class="native"/>
      </id>
      <property name="nombre" column="nombre" type="string"/>
      <property name="nivel" column="nivel" type="int"/>
    	<many-to-one class="Idioma" name="Idioma" unique="true"/>
     <list name="lecciones" cascade="all">
       <key column="curso_id" />  
       <list-index column="idx"/>
       <one-to-many class="Leccion"/>
     </list>  
   </class>

   <class name="Prueba" table="Prueba">
      <id name="id" type="long" column="prueba_id">
        <generator class="native"/>
      </id>
    	<many-to-one class="Leccion" name="leccion" unique="true"/>
      <property name="puntaje" column="puntaje" type="integer"/>
   </class>

   <class name="Idioma" table="Idioma">
      <meta attribute="class-description">
         This class contains the idioma detail. 
      </meta>
      <id name="id" type="long" column="idioma_id">
         <generator class="native"/>
      </id>
      <property name="nombre" column="nombre" type="string"/>
      <many-to-one name="diccionario" column="diccionario" class="Diccionario" unique="true"/>
   </class>

   <class name="Diccionario" table="Diccionario">
      <meta attribute="class-description">
         This class contains the diccionario detail. 
      </meta>
      <id name="id" type="long" column="diccionario_id">
         <generator class="native"/>
      </id>
      <property name="edicion" column="edicion" type="string"/>
      <map name="definiciones" table="DEFINICIONES" cascade="all">  
        <key column="diccionario_id"></key> 
        <index column="index" type="string"></index>  
        <element column="element" type="string"></element>  
      </map>  
      <many-to-one name="idioma" column="idioma" class="Idioma" unique="true"/>
   </class>

   <class name="Usuario" table="Usuario">
     <meta attribute="class-description">
       This class contains the documento detail. 
     </meta>
     <id name="id" type="long" column="usuario_id">
     </id>
     <property name="nombre" column="nombre" type="string"/>
     <property name="email" column="email" type="string"/>
     <property name="fechaDeCreacion" column="fechaDeCreacion" type="date"/>
     <list name="traducciones" cascade="all">
       <key column="usuario_id" />  
       <list-index column="idx"/>
       <one-to-many class="Traduccion"/>
     </list>  
     <list name="cursadasRealizadas" cascade="all">
       <key column="usuario_id" />  
       <list-index column="idx"/>
       <one-to-many class="Cursada"/>
     </list>  
     <joined-subclass name="Moderador" table="MODERADOR">
       <key column="usuario_id"/>
       <list name="evaluaciones" cascade="all">
         <key column="moderador_id" />  
         <list-index column="idx"/>
         <one-to-many class="Evaluacion"/>
       </list>  
       <list name="idiomas" cascade="all">
         <key column="moderador_id" />  
         <list-index column="idx"/>
         <one-to-many class="Idioma"/>
       </list>  
     </joined-subclass>
   </class>

   <class name="Cursada" table="Cursada">
      <id name="id" type="long" column="cursada_id">
         <generator class="native"/>
      </id>
      <property name="inicio" column="inicio" type="date"/>
    	<many-to-one class="Curso" name="curso" unique="true"/>
    	<many-to-one class="Usuario" name="usuario" unique="true" />
      <list name="pruebas" cascade="all">
        <key column="cursada_id" />  
        <list-index column="idx"/>
	      <one-to-many class="Prueba"/>
      </list>  
   </class>

   <class name="Tarea" table="Tarea">
      <id name="id" type="long" column="tarea_id">
        <generator class="native"/>
      </id>
      <discriminator column='tarea_type' type="string"/>
      <property name="fecha" column="fecha" type="date"/>
      <property name="descripcion" column="descripcion" type="string"/>
      <property name="completa" column="completa" type="boolean"/>
      <subclass name='Traduccion' discriminator-value='TRADUCCION'>
      </subclass>
      <subclass name='Evaluacion' discriminator-value='EVALUACION'>
      </subclass>
   </class>

   <class name="Parrafo" table="Parrafo">
      <id name="id" type="long" column="parrafo_id">
        <generator class="native"/>
      </id>
      <property name="texto" column="texto" type="string"/>
      <many-to-one name="documento" column="idioma" class="Idioma" unique="true"/>
   </class>

   <class name="Documento" table="Documento">
      <meta attribute="class-description">
         This class contains the documento detail. 
      </meta>
      <id name="id" type="long" column="documento_id">
      
      </id>
      <property name="nombre" column="nombre" type="string"/>
      <property name="complejidad" column="complejidad" type="int"/>
      <list name="parrafos" cascade="all">
        <key column="documento_id" />  
        <list-index column="idx"/>
      	<one-to-many class="Parrafo"/>
      </list>  
     <many-to-one name="idioma" column="idioma" class="Idioma" unique="true"/>
   </class>

   <class name="Sitio" table="Sitio">
      <meta attribute="class-description">
         This class contains the sitio detail. 
      </meta>
      <id name="id" type="long" column="sitio_id">
      </id>
      <list name="usuarios" cascade="all">
        <key column="sitio_id" />  
        <list-index column="idx"/>
      	<one-to-many class="Usuario"/>
      </list>  
      <list name="documentos" cascade="all">
        <key column="sitio_id" />  
        <list-index column="idx"/>
      	<one-to-many class="Documento"/>
      </list>  
      <list name="cursos" cascade="all">
        <key column="sitio_id" />  
        <list-index column="idx"/>
      	<one-to-many class="Curso"/>
      </list>  
   </class>


</hibernate-mapping>
	
